<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · Mongoc.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Mongoc.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../tutorial/">Tutorial</a></li><li><a class="toctext" href="../crud/">CRUD Operations</a></li><li><a class="toctext" href="../authentication/">Authentication</a></li><li><a class="toctext" href="../transaction/">Transactions</a></li><li class="current"><a class="toctext" href>API Reference</a><ul class="internal"><li><a class="toctext" href="#BSON-1">BSON</a></li><li><a class="toctext" href="#Client-1">Client</a></li><li><a class="toctext" href="#Database-1">Database</a></li><li><a class="toctext" href="#Collection-1">Collection</a></li><li><a class="toctext" href="#Aggregation-1">Aggregation</a></li><li><a class="toctext" href="#Session-1">Session</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>API Reference</a></li></ul><a class="edit-page" href="https://github.com/felipenoris/Mongoc.jl/blob/master/docs/src/api.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>API Reference</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="API-Reference-1" href="#API-Reference-1">API Reference</a></h1><h2><a class="nav-anchor" id="BSON-1" href="#BSON-1">BSON</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSON" href="#Mongoc.BSON"><code>Mongoc.BSON</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>A <code>BSON</code> represents a document in <em>Binary JSON</em> format, defined at http://bsonspec.org/.</p><p>In Julia, you can manipulate a <code>BSON</code> instance just like a <code>Dict</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">bson = Mongoc.BSON()
bson[&quot;name&quot;] = &quot;my name&quot;
bson[&quot;num&quot;] = 10.0</code></pre><p><strong>C API</strong></p><p><code>BSON</code> is a wrapper for C struct <code>bson_t</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L170-L188">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONObjectId" href="#Mongoc.BSONObjectId"><code>Mongoc.BSONObjectId</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>A <code>BSONObjectId</code> represents a unique identifier for a BSON document.</p><p><strong>Example</strong></p><p>The following generates a new <code>BSONObjectId</code>.</p><pre><code class="language-julia">julia&gt; Mongoc.BSONObjectId()</code></pre><p><strong>C API</strong></p><p><code>BSONObjectId</code> instances addresses are passed to libbson/libmongoc API using <code>Ref(oid)</code>, and are owned by the Julia process.</p><p>Mirrors C struct <code>bson_oid_t</code>:</p><pre><code class="language-c">typedef struct {
   uint8_t bytes[12];
} bson_oid_t;</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L78-L103">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONCode" href="#Mongoc.BSONCode"><code>Mongoc.BSONCode</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>BSONCode</code> is a BSON element with JavaScript source code.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; bson = Mongoc.BSON(&quot;source&quot; =&gt; Mongoc.BSONCode(&quot;function() = 1&quot;))
BSON(&quot;{ &quot;source&quot; : { &quot;$code&quot; : &quot;function() = 1&quot; } }&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L155-L165">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.as_json" href="#Mongoc.as_json"><code>Mongoc.as_json</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">as_json(bson::BSON; canonical::Bool=false) :: String</code></pre><p>Converts a <code>bson</code> object to a JSON string.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; document = Mongoc.BSON(&quot;{ &quot;hey&quot; : 1 }&quot;)
BSON(&quot;{ &quot;hey&quot; : 1 }&quot;)

julia&gt; Mongoc.as_json(document)
&quot;{ &quot;hey&quot; : 1 }&quot;

julia&gt; Mongoc.as_json(document, canonical=true)
&quot;{ &quot;hey&quot; : { &quot;$numberInt&quot; : &quot;1&quot; } }&quot;</code></pre><p><strong>C API</strong></p><ul><li><p><a href="http://mongoc.org/libbson/current/bson_as_canonical_extended_json.html"><code>bson_as_canonical_extended_json</code></a></p></li><li><p><a href="http://mongoc.org/libbson/current/bson_as_relaxed_extended_json.html"><code>bson_as_relaxed_extended_json</code></a></p></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L359-L382">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.as_dict" href="#Mongoc.as_dict"><code>Mongoc.as_dict</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">as_dict(document::BSON) :: Dict</code></pre><p>Converts a BSON document to a Julia <code>Dict</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L445-L449">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.read_bson" href="#Mongoc.read_bson"><code>Mongoc.read_bson</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">read_bson(io::IO) :: Vector{BSON}</code></pre><p>Reads all BSON documents from <code>io</code>. This method will continue to read from <code>io</code> until it reaches eof.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L762-L768">source</a><div><div><pre><code class="language-none">read_bson(data::Vector{UInt8}) :: Vector{BSON}</code></pre><p>Parses a vector of bytes to a vector of BSON documents. Useful when reading BSON as binary from a stream.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L771-L776">source</a><div><div><pre><code class="language-none">read_bson(filepath::AbstractString) :: Vector{BSON}</code></pre><p>Reads all BSON documents from a file located at <code>filepath</code>.</p><p>This will open a <code>Mongoc.BSONReader</code> pointing to the file and will parse file contents to BSON documents.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L792-L799">source</a><div><div><pre><code class="language-none">read_bson(reader::BSONReader) :: Vector{BSON}</code></pre><p>Reads all BSON documents from a <code>reader</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L811-L815">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.write_bson" href="#Mongoc.write_bson"><code>Mongoc.write_bson</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">write_bson(io::IO, bson::BSON;
    initial_buffer_capacity::Integer=DEFAULT_BSON_WRITER_BUFFER_CAPACITY)</code></pre><p>Writes a single BSON document to <code>io</code> in binary format.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L700-L705">source</a><div><div><pre><code class="language-none">write_bson(io::IO, bson_list::Vector{BSON};
    initial_buffer_capacity::Integer=DEFAULT_BSON_WRITER_BUFFER_CAPACITY)</code></pre><p>Writes a vector of BSON documents to <code>io</code> in binary format.</p><p><strong>Example</strong></p><pre><code class="language-julia">list = Vector{Mongoc.BSON}()

let
    src = Mongoc.BSON()
    src[&quot;id&quot;] = 1
    src[&quot;name&quot;] = &quot;1st&quot;
    push!(list, src)
end

let
    src = Mongoc.BSON()
    src[&quot;id&quot;] = 2
    src[&quot;name&quot;] = &quot;2nd&quot;
    push!(list, src)
end

open(&quot;documents.bson&quot;, &quot;w&quot;) do io
    Mongoc.write_bson(io, list)
end</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L718-L747">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.read_next_bson" href="#Mongoc.read_next_bson"><code>Mongoc.read_next_bson</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">read_next_bson(reader::BSONReader) :: Union{Nothing, BSON}</code></pre><p>Reads the next BSON document available in the stream pointed by <code>reader</code>. Returns <code>nothing</code> if reached the end of the stream.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L826-L831">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.BSONError" href="#Mongoc.BSONError"><code>Mongoc.BSONError</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>BSONError</code> is the default <code>Exception</code> for BSON/MongoDB function call errors.</p><p><strong>C API</strong></p><p>Mirrors C struct <code>bson_error_t</code>.</p><p><code>BSONError</code> instances addresses are passed to libbson/libmongoc API using <code>Ref(error)</code>, and are owned by the Julia process.</p><pre><code class="language-c">typedef struct {
   uint32_t domain;
   uint32_t code;
   char message[504];
} bson_error_t;</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/bson.jl#L129-L148">source</a></section><h2><a class="nav-anchor" id="Client-1" href="#Client-1">Client</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.Client" href="#Mongoc.Client"><code>Mongoc.Client</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Client(host, port)
Client(uri)
Client()</code></pre><p>Creates a <code>Client</code>, which represents a connection to a MongoDB database.</p><p><strong>Examples:</strong></p><p>These lines are equivalent.</p><pre><code class="language-julia">c = Mongoc.Client()
c = Mongoc.Client(&quot;localhost&quot;, 27017)
c = Mongoc.Client(&quot;mongodb://localhost:27017&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/client.jl#L6-L22">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.set_appname!" href="#Mongoc.set_appname!"><code>Mongoc.set_appname!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">set_appname!(client::Client, appname::String)</code></pre><p>Sets the application name for this client.</p><p>This string, along with other internal driver details, is sent to the server as part of the initial connection handshake.</p><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_client_set_appname.html"><code>mongoc_client_set_appname</code></a>.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/client.jl#L27-L38">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.ping" href="#Mongoc.ping"><code>Mongoc.ping</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">ping(client::Client) :: BSON</code></pre><p>Pings the server, testing wether it is reachable.</p><p>One thing to keep in mind is that operations on MongoDB are <em>lazy</em>, which means that a client reaches a server only when it needs to transfer documents.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; client = Mongoc.Client() # nothing happens here between client and server
Client(URI(&quot;mongodb://localhost:27017&quot;))

julia&gt; Mongoc.ping(client) # connection to server happens here
BSON(&quot;{ &quot;ok&quot; : 1.0 }&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/client.jl#L47-L65">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.get_server_mongodb_version" href="#Mongoc.get_server_mongodb_version"><code>Mongoc.get_server_mongodb_version</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_server_mongodb_version(client::Client) :: VersionNumber</code></pre><p>Queries the version for the MongoDB server instance.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/client.jl#L70-L74">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.find_databases" href="#Mongoc.find_databases"><code>Mongoc.find_databases</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">find_databases(client::Client; options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Queries for databases.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/client.jl#L80-L84">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.get_database_names" href="#Mongoc.get_database_names"><code>Mongoc.get_database_names</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_database_names(client::Client; options::Union{Nothing, BSON}=nothing) :: Vector{String}</code></pre><p>Helper method to get a list of names for all databases.</p><p>See also <a href="#Mongoc.find_databases"><code>Mongoc.find_databases</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/client.jl#L94-L100">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.has_database" href="#Mongoc.has_database"><code>Mongoc.has_database</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">has_database(client::Client, database_name::String;
    options::Union{Nothing, BSON}=nothing) :: Bool</code></pre><p>Helper method to check if there is a database named <code>database_name</code>.</p><p>See also <a href="#Mongoc.find_databases"><code>Mongoc.find_databases</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/client.jl#L109-L116">source</a></section><h2><a class="nav-anchor" id="Database-1" href="#Database-1">Database</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.command_simple" href="#Mongoc.command_simple"><code>Mongoc.command_simple</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">command_simple(database::Database, command::BSON) :: BSON
command_simple(collection::Collection, command::BSON) :: BSON</code></pre><p>Executes a <code>command</code> given by a JSON string or a BSON instance.</p><p>It returns the first document from the result cursor.</p><p><strong>Example</strong></p><pre><code class="language-julia">julia&gt; client = Mongoc.Client() # connects to localhost at port 27017
Client(URI(&quot;mongodb://localhost:27017&quot;))

julia&gt; bson_result = Mongoc.command_simple(client[&quot;admin&quot;], &quot;{ &quot;ping&quot; : 1 }&quot;)
BSON(&quot;{ &quot;ok&quot; : 1.0 }&quot;)</code></pre><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_database_command_simple.html"><code>mongoc_database_command_simple</code></a></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/database.jl#L5-L26">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.add_user" href="#Mongoc.add_user"><code>Mongoc.add_user</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">add_user(database::Database, username::String, password::String, roles::Union{Nothing, BSON},
    custom_data::Union{Nothing, BSON}=nothing)</code></pre><p>This function shall create a new user with access to database.</p><p><strong>Warning:</strong> Do not call this function without TLS.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/database.jl#L39-L46">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.remove_user" href="#Mongoc.remove_user"><code>Mongoc.remove_user</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">remove_user(database::Database, username::String)</code></pre><p>Removes a user from database.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/database.jl#L61-L65">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.has_user" href="#Mongoc.has_user"><code>Mongoc.has_user</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">has_user(database::Database, user_name::String) :: Bool</code></pre><p>Checks if <code>database</code> has a user named <code>user_name</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/database.jl#L75-L79">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.find_collections" href="#Mongoc.find_collections"><code>Mongoc.find_collections</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">find_collections(database::Database; options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Queries for collections in a <code>database</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/database.jl#L85-L89">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.get_collection_names" href="#Mongoc.get_collection_names"><code>Mongoc.get_collection_names</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">get_collection_names(database::Database;
    options::Union{Nothing, BSON}=nothing) :: Vector{String}</code></pre><p>Helper method to get collection names.</p><p>See also <a href="#Mongoc.find_collections"><code>Mongoc.find_collections</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/database.jl#L99-L106">source</a></section><h2><a class="nav-anchor" id="Collection-1" href="#Collection-1">Collection</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.find" href="#Mongoc.find"><code>Mongoc.find</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">find(collection::Collection, bson_filter::BSON=BSON();
    options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Executes a query on <code>collection</code> and returns an iterable <code>Cursor</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia">function find_contract_codes(collection, criteria::Dict=Dict()) :: Vector{String}
    result = Vector{String}()

    let
        bson_filter = Mongoc.BSON(criteria)
        bson_options = Mongoc.BSON(&quot;&quot;&quot;{ &quot;projection&quot; : { &quot;_id&quot; : true }, &quot;sort&quot; : { &quot;_id&quot; : 1 } }&quot;&quot;&quot;)
        for bson_document in Mongoc.find(collection, bson_filter, options=bson_options)
            push!(result, bson_document[&quot;_id&quot;])
        end
    end

    return result
end</code></pre><p>Check the <a href="http://mongoc.org/libmongoc/current/mongoc_collection_find_with_opts.html">libmongoc documentation</a> for more information.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/collection.jl#L158-L184">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.find_one" href="#Mongoc.find_one"><code>Mongoc.find_one</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">find_one(collection::Collection, bson_filter::BSON=BSON();
    options::Union{Nothing, BSON}=nothing) :: Union{Nothing, BSON}</code></pre><p>Execute a query to a collection and returns the first element of the result set.</p><p>Returns <code>nothing</code> if the result set is empty.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/collection.jl#L236-L243">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.count_documents" href="#Mongoc.count_documents"><code>Mongoc.count_documents</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">count_documents(collection::Collection, bson_filter::BSON=BSON();
    options::Union{Nothing, BSON}=nothing) :: Int</code></pre><p>Returns the number of documents on a <code>collection</code>, with an optional filter given by <code>bson_filter</code>.</p><p><code>length(collection)</code> and <code>Mongoc.count_documents(collection)</code> produces the same output.</p><p><strong>Example</strong></p><pre><code class="language-julia">result = length(collection, Mongoc.BSON(&quot;_id&quot; =&gt; oid))</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/collection.jl#L198-L213">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.drop" href="#Mongoc.drop"><code>Mongoc.drop</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">drop(database::Database, opts::Union{Nothing, BSON}=nothing)
drop(collection::Collection, opts::Union{Nothing, BSON}=nothing)</code></pre><p>Drops <code>database</code> or <code>collection</code>.</p><p>For information about <code>opts</code> argument, check the libmongoc documentation for <a href="http://mongoc.org/libmongoc/current/mongoc_database_drop_with_opts.html">database drop</a> or <a href="http://mongoc.org/libmongoc/current/mongoc_collection_drop_with_opts.html">collection drop</a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/collection.jl#L315-L325">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.find_and_modify" href="#Mongoc.find_and_modify"><code>Mongoc.find_and_modify</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">find_and_modify(collection::Collection, query::BSON;
    update::Union{Nothing, BSON}=nothing,
    sort::Union{Nothing, BSON}=nothing,
    fields::Union{Nothing, BSON}=nothing,
    flags::Union{Nothing, FindAndModifyFlags}=nothing,
    bypass_document_validation::Bool=false,
) :: BSON</code></pre><p>Find documents and updates them in one go.</p><p>See <a href="#Mongoc.FindAndModifyFlags"><code>Mongoc.FindAndModifyFlags</code></a> for a list of accepted values for <code>flags</code> argument.</p><p><strong>C API</strong></p><ul><li><a href="http://mongoc.org/libmongoc/current/mongoc_collection_find_and_modify.html">mongoc<em>collection</em>find<em>and</em>modify</a>.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/collection.jl#L403-L420">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.FindAndModifyFlags" href="#Mongoc.FindAndModifyFlags"><code>Mongoc.FindAndModifyFlags</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Adds one or more flags to the <code>FindAndModifyOptsBuilder</code>. These flags can be <em>ORed</em> together, as in <code>flags = Mongoc.FIND_AND_MODIFY_FLAG_UPSERT | Mongoc.FIND_AND_MODIFY_FLAG_RETURN_NEW</code>.</p><ul><li><p><code>FIND_AND_MODIFY_FLAG_NONE</code>: Default. Doesn’t add anything to the builder.</p></li><li><p><code>FIND_AND_MODIFY_FLAG_REMOVE</code>: Will instruct find<em>and</em>modify to remove the matching document.</p></li><li><p><code>FIND_AND_MODIFY_FLAG_UPSERT</code>: Update the matching document or, if no document matches, insert the document.</p></li><li><p><code>FIND_AND_MODIFY_FLAG_RETURN_NEW</code>: Return the resulting document.</p></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/types.jl#L45-L57">source</a></section><h2><a class="nav-anchor" id="Aggregation-1" href="#Aggregation-1">Aggregation</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.aggregate" href="#Mongoc.aggregate"><code>Mongoc.aggregate</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">aggregate(collection::Collection, bson_pipeline::BSON;
    flags::QueryFlags=QUERY_FLAG_NONE,
    options::Union{Nothing, BSON}=nothing) :: Cursor</code></pre><p>Use <code>Mongoc.aggregate</code> to execute an aggregation command.</p><p><strong>Example</strong></p><p>The following reproduces the example from the <a href="https://docs.mongodb.com/manual/aggregation/">MongoDB Tutorial</a>.</p><pre><code class="language-julia">docs = [
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;A123&quot;, &quot;amount&quot; : 500, &quot;status&quot; : &quot;A&quot; }&quot;&quot;&quot;),
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;A123&quot;, &quot;amount&quot; : 250, &quot;status&quot; : &quot;A&quot; }&quot;&quot;&quot;),
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;B212&quot;, &quot;amount&quot; : 200, &quot;status&quot; : &quot;A&quot; }&quot;&quot;&quot;),
    Mongoc.BSON(&quot;&quot;&quot;{ &quot;cust_id&quot; : &quot;A123&quot;, &quot;amount&quot; : 300, &quot;status&quot; : &quot;D&quot; }&quot;&quot;&quot;)
]

collection = client[&quot;my-database&quot;][&quot;aggregation-collection&quot;]
append!(collection, docs)

# Sets the pipeline command
bson_pipeline = Mongoc.BSON(&quot;&quot;&quot;
    [
        { &quot;$match&quot; : { &quot;status&quot; : &quot;A&quot; } },
        { &quot;$group&quot; : { &quot;_id&quot; : &quot;$cust_id&quot;, &quot;total&quot; : { &quot;$sum&quot; : &quot;$amount&quot; } } }
    ]
&quot;&quot;&quot;)

for doc in Mongoc.aggregate(collection, bson_pipeline)
  println(doc)
end</code></pre><p>The result of the script above is:</p><pre><code class="language-julia">BSON(&quot;{ &quot;_id&quot; : &quot;B212&quot;, &quot;total&quot; : 200 }&quot;)
BSON(&quot;{ &quot;_id&quot; : &quot;A123&quot;, &quot;total&quot; : 750 }&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/collection.jl#L258-L300">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.QueryFlags" href="#Mongoc.QueryFlags"><code>Mongoc.QueryFlags</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p><code>QueryFlags</code> correspond to the MongoDB wire protocol. They may be bitwise or’d together. They may modify how a query is performed in the MongoDB server.</p><p>These flags are passed as optional argument for the aggregation function <code>Mongoc.aggregate</code>.</p><p>This data type mirrors C struct <code>mongoc_query_flags_t</code>. See <a href="http://mongoc.org/libmongoc/current/mongoc_query_flags_t.html">libmongoc docs</a> for more information.</p><p><strong>Constants</strong></p><p><code>Mongoc.QUERY_FLAG_NONE</code>: Specify no query flags.</p><p><code>Mongoc.QUERY_FLAG_TAILABLE_CURSOR</code>: Cursor will not be closed when the last data is retrieved. You can resume this cursor later.</p><p><code>Mongoc.QUERY_FLAG_SLAVE_OK</code>: Allow query of replica set secondaries.</p><p><code>Mongoc.QUERY_FLAG_OPLOG_REPLAY</code>: Used internally by MongoDB.</p><p><code>Mongoc.QUERY_FLAG_NO_CURSOR_TIMEOUT</code>: The server normally times out an idle cursor after an inactivity period (10 minutes). This prevents that.</p><p><code>Mongoc.QUERY_FLAG_AWAIT_DATA</code>: Use with <code>Mongoc.MONGOC_QUERY_TAILABLE_CURSOR</code>. Block rather than returning no data. After a period, time out.</p><p><code>Mongoc.QUERY_FLAG_EXHAUST</code>: Stream the data down full blast in multiple &quot;reply&quot; packets. Faster when you are pulling down a lot of data and you know you want to retrieve it all.</p><p><code>Mongoc.QUERY_FLAG_PARTIAL</code>: Get partial results from mongos if some shards are down (instead of throwing an error).</p></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/types.jl#L2-L42">source</a></section><h2><a class="nav-anchor" id="Session-1" href="#Session-1">Session</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Mongoc.transaction" href="#Mongoc.transaction"><code>Mongoc.transaction</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">transaction(f::Function, client::Client; session_options::SessionOptions=SessionOptions())</code></pre><p>Use <em>do-syntax</em> to execute a transaction.</p><p>Transaction will be commited automatically. If an error occurs, the transaction is aborted.</p><p>The <code>session</code> parameter should be treated the same way as a <code>Client</code>: from a <code>session</code> you get a <code>database</code>, and a <code>collection</code> that are bound to the session.</p><pre><code class="language-julia">Mongoc.transaction(client) do session
    database = session[&quot;my_database&quot;]
    collection = database[&quot;my_collection&quot;]
    new_item = Mongoc.BSON()
    new_item[&quot;inserted&quot;] = true
    push!(collection, new_item)
end</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/felipenoris/Mongoc.jl/blob/f731a4a5b1ed60ff9f71eb6db42dc218877d29e5/src/session.jl#L158-L178">source</a></section><footer><hr/><a class="previous" href="../transaction/"><span class="direction">Previous</span><span class="title">Transactions</span></a></footer></article></body></html>
